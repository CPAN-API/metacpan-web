name: Update cpanfile.snapshot
on:
    schedule:
        - cron: "1 15 * * 0"
    workflow_dispatch:
jobs:
    update-dep:
        runs-on: "ubuntu-20.04"
        steps:
            - uses: actions/checkout@v2.3.4
            - name: Install deps
              run: >
                  curl -sL https://git.io/cpm | perl -
                  install
                  --cpanfile cpanfile
                  --resolver metacpan
                  --show-build-log-on-failure
                  --local-lib-contained=local
            - name: Maybe update cpanfile.snapshot
              run: perl -Ilocal/lib/perl5 local/bin/carton
            - name: Create Pull Request
              uses: peter-evans/create-pull-request@v3.8.2
              with:
                  commit-message: Update cpanfile.snapshot
                  title: Update cpanfile.snapshot
                  body: |
                      Auto-generated by [create-pull-request][1]

                      [1]: https://github.com/peter-evans/create-pull-request
                  branch: update-cpanfile-snapshot
